import logging
import joblib
import glob
import os
import pandas as pd

save_directory = "D:\\Malware\\saves"

logging.info("Loading Features from file")
dat_files = glob.glob(os.path.join(save_directory, '*feature*.gz'))

print(f"    file  |   file_hash   |   label     |  rows  | col")
for file in dat_files:
    # print("Loading Features from " + file)
    # logging.info("Loading Features from " + file)
    df_features = joblib.load(file)

    file_hash_flag = False
    label_flag = False
    if 'file_hash' in df_features:
        file_hash_flag = True
    if 'label' in df_features:
        label_flag = True

    print(f"    {file}  |   {file_hash_flag}   |   {label_flag}  |  {len(df_features.index)}  | {len(df_features.columns)}")
